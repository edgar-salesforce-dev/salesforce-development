<template>
    <lightning-card icon-name="action:follow">
        <h1 slot="title">
            Developer Task Manager - TMP
        </h1>
        <header slot="actions">
            <lightning-button-group>
                <lightning-button 
                    label="Refresh Developer Tasks"
                    icon-name="utility:refresh"
                    onclick={handleRefreshTasks} 
                ></lightning-button>
                <lightning-button 
                    label="Delete Tasks"
                    icon-name="utility:bucket"
                    onclick={handleMassiveActionTasks}
                    name="delete"
                ></lightning-button>
                <lightning-button 
                    label="Create New Task"
                    icon-name="utility:add"
                    onclick={handleCreateTask}
                    name="create"
                ></lightning-button>
            </lightning-button-group>
        </header>
        <main class="slds-var-p-around_large">
            <lightning-layout multiple-rows>
                <lightning-layout-item size="12" large-device-size="12" medium-device-size="12" small-device-size="12" padding="around-small">
                    <!-- Task Cards Container -->
                    <template lwc:if={isData}>
                        <section class="tasks-container">
                            <section class="tasks-item slds-var-p-around_medium tasks-not-started">
                                <h2 class="slds-text-align_center slds-text-heading_small slds-var-m-bottom_medium">Not Started</h2>
                                <template for:each={tasksNotStarted} for:item="task">
                                    <div class="slds-var-m-vertical_small" key={task.Id} >
                                        <c-tmp-dev-task-card task={task} onnavigate={handleNavigateTask}></c-tmp-dev-task-card>
                                    </div>
                                </template>
                            </section>
                            <section class="tasks-item slds-var-p-around_medium tasks-in-progress">
                                <h2 class="slds-text-align_center slds-text-heading_small slds-var-m-bottom_medium">In Progress</h2>
                                <template for:each={tasksInProgress} for:item="task">
                                    <div class="slds-var-m-vertical_small" key={task.Id} >
                                        <c-tmp-dev-task-card task={task} onnavigate={handleNavigateTask}></c-tmp-dev-task-card>
                                    </div>
                                </template>
                            </section>
                            <section class="tasks-item slds-var-p-around_medium tasks-completed">
                                <h2 class="slds-text-align_center slds-text-heading_small slds-var-m-bottom_medium">Completed</h2>
                                <template for:each={tasksCompleted} for:item="task">
                                    <div class="slds-var-m-vertical_small" key={task.Id} >
                                        <c-tmp-dev-task-card task={task} onnavigate={handleNavigateTask}></c-tmp-dev-task-card>
                                    </div>
                                </template>
                            </section>
                        </section>
                    </template>
                    <template lwc:else>
                        <article class="slds-box">
                            <p class="slds-text-align_center">
                                There is no data to show...
                            </p>
                        </article>
                    </template>
                </lightning-layout-item>
            </lightning-layout>
        </main>
    </lightning-card>
    <template lwc:if={showCreateForm}>
        <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open" aria-labelledby="modal-heading-01" aria-modal="true">
            <div class="slds-modal__container">
                <header class="slds-modal__header">
                    <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">Create Developer Task</h2>
                </header>
                <div class="slds-modal__content slds-var-p-around_large" id="modal-content-id-1">
                    <form class="slds-box" onsubmit={handleSubmit}>
                        <lightning-input class="input-form" type="text" label="Title" onchange={handleInputChange} name="Title__c" placeholder="Task Title" required></lightning-input>
                        <lightning-textarea class="input-form" label="Description" onchange={handleInputChange} name="Description__c" placeholder="Task Description..."></lightning-textarea>
                        <lightning-input class="input-form" type="date" label="Due Date" onchange={handleInputChange} name="Due_Date__c" placeholder="Task Due Date"></lightning-input>
                        <lightning-combobox class="input-form" label="Status" options={statusOptions} onchange={handleInputChange} name="Status__c"></lightning-combobox>
                        <lightning-record-picker class="input-form" label="Owner" placeholder="Task Owner" object-api-name={objectApiName}
                            onchange={handleInputChange} name="Owner__c" required></lightning-record-picker>
                        <div class="slds-var-m-top_large slds-align_absolute-center">
                            <lightning-button label="Create" variant="brand" type="submit"></lightning-button>
                            <lightning-button label="Cancel" onclick={closeModal} class="slds-var-m-left_x-small"></lightning-button>
                        </div>
                    </form>
                </div>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
</template>